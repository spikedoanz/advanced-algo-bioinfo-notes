> from slide EM algo for phasing: G={G1=11, G2=12, G3=22}.
> 
> Possible haplotypes of G: h1=11, h2=00, h3=10, h4=01
> 
> In class we did 1 iteration of EM, finish the second and 3d iterations
> 
> Iteration  0        1          2      3    
> 
> F1      .25      7/12        ?       ?
> F2      .25      1/12        ?       ?
> F3      .25      3/12        ?       ?
> F4      .25      1/12        ?       ?
> 
> h1h2   .5        .7            ?       ?
> h3h4   .5        .3            ?       ?

--------------------------------------------------------------------------------

# em algorithm for haplotype phasing - iterations 2 and 3

## given setup
- genotypes: G1=11, G2=12, G3=22
- haplotypes: h1=11, h2=00, h3=10, h4=01
- G1→h1h1, G2→h1h2 or h3h4, G3→h2h2
- iteration 1 given: F1=7/12, F2=1/12, F3=3/12, F4=1/12

## iteration 2
### e-step
for G2=12:
- P(h1h2|G2) = (2×F1×F2)/(2×F1×F2 + 2×F3×F4)
- = (2×7/12×1/12)/(2×7/12×1/12 + 2×3/12×1/12)
- = (14/144)/(20/144) = 14/20 = 0.7
- P(h3h4|G2) = 6/20 = 0.3

### m-step
expected counts:
- h1: 2(G1) + 0.7(G2) = 2.7
- h2: 2(G3) + 0.7(G2) = 2.7
- h3: 0.3(G2) = 0.3
- h4: 0.3(G2) = 0.3
- total: 6

new frequencies:
- F1 = 2.7/6 = 9/20
- F2 = 2.7/6 = 9/20
- F3 = 0.3/6 = 1/20
- F4 = 0.3/6 = 1/20

## iteration 3
### e-step
for G2=12:
- P(h1h2|G2) = (2×9/20×9/20)/(2×9/20×9/20 + 2×1/20×1/20)
- = (162/400)/(164/400) = 81/82
- P(h3h4|G2) = 1/82

### m-step
expected counts:
- h1: 2 + 81/82 = 245/82
- h2: 2 + 81/82 = 245/82
- h3: 1/82
- h4: 1/82
- total: 6

new frequencies:
- F1 = (245/82)/6 = 245/492
- F2 = (245/82)/6 = 245/492
- F3 = (1/82)/6 = 1/492
- F4 = (1/82)/6 = 1/492

--------------------------------------------------------------------------------

## summary table

| iteration     | 0    | 1     | 2     | 3      |
|---------------|------|-------|-------|--------|
| F1            | 0.25 | 7/12  | 9/20  | 245/492|
| F2            | 0.25 | 1/12  | 9/20  | 245/492|
| F3            | 0.25 | 3/12  | 1/20  | 1/492  |
| F4            | 0.25 | 1/12  | 1/20  | 1/492  |
| P(h1h2\|G2)   | 0.5  | 0.7   | 0.7   | 81/82  |
| P(h3h4\|G2)   | 0.5  | 0.3   | 0.3   | 1/82   |

converging to F1=F2≈0.5, F3=F4≈0, meaning G2 phases as h1h2
